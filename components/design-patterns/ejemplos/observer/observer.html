<h1 class="title">Patrón Observer</h1>

<p>El patrón <strong>Observer</strong> es un patrón de diseño de comportamiento que permite definir un mecanismo de suscripción para notificar a varios objetos sobre cualquier evento que le suceda al objeto que están observando.</p>

<h2 class="subtitle">Propósito</h2>
<p>Definir una dependencia uno-a-muchos entre objetos para que cuando un objeto cambie de estado, todos sus dependientes sean notificados y actualizados automáticamnte.</p>

<h2 class="subtitle">Caso de Uso Real: Suscripción a Canales de YouTube</h2>
<p><strong>Contexto:</strong> Tienes creadores de contenido (YouTubers) y millones de usuarios (Suscriptores). Un usuario quiere saber al instante cuándo su creador favorito sube un video.</p>

<p><strong>El Problema:</strong> Sin el patrón Observer, la única forma de saber si hay contenido nuevo sería que cada usuario entrara al canal constantemente a comprobar (Polling).
<br>Imagina a 1 millón de usuarios refrescando la página cada segundo para ver si hay video nuevo. Esto saturaría el servidor y desperdiciaría recursos. Además, el Creador tendría que tener un código hardcodeado para avisar a cada usuario específico, lo cual es inmanejable.</p>

<p><strong>La Solución (Observer):</strong> Invertimos el control. En lugar de que el usuario pregunte, el canal <strong>notifica</strong>.
<br>Los usuarios se "suscriben" (se añaden a una lista). Cuando el canal sube un video, recorre esa lista y avisa a todos. El canal no conoce a los usuarios, solo sabe que tiene una lista de "cosas que quieren ser avisadas". Esto es mucho más eficiente y escalable.</p>

<h2 class="subtitle">Implementación</h2>

<div class="center-horizontal">
<pre><code class="language-java">
import java.util.ArrayList;
import java.util.List;

// Interfaz Observador
interface Observer {
    void update(String videoTitle);
}

// Interfaz Sujeto
interface Subject {
    void subscribe(Observer observer);
    void unsubscribe(Observer observer);
    void notifyObservers(String videoTitle);
}

// Sujeto Concreto: Canal de Youtube
class YoutubeChannel implements Subject {
    private List<Observer> subscribers = new ArrayList<>();
    private String channelName;

    public YoutubeChannel(String channelName) {
        this.channelName = channelName;
    }

    @Override
    public void subscribe(Observer observer) {
        subscribers.add(observer);
    }

    @Override
    public void unsubscribe(Observer observer) {
        subscribers.remove(observer);
    }

    @Override
    public void notifyObservers(String videoTitle) {
        for (Observer observer : subscribers) {
            observer.update(videoTitle);
        }
    }

    public void uploadVideo(String title) {
        System.out.println(channelName + " ha subido un nuevo video: " + title);
        notifyObservers(title);
    }
}

// Observador Concreto: Suscriptor
class Subscriber implements Observer {
    private String name;

    public Subscriber(String name) {
        this.name = name;
    }

    @Override
    public void update(String videoTitle) {
        System.out.println("Hola " + name + ", ¡hay un nuevo video: " + videoTitle + "!");
    }
}
</code></pre>
</div>
<span class="center-horizontal caption">Esquema Observer: Youtube Channel y Subscribers</span>

<br>

<h2 class="subtitle">Análisis de la Implementación</h2>

<ul>
    <li>
        <strong>Interfaces <code>Observer</code> y <code>Subject</code>:</strong> 
        <p>Permiten que el <code>Subject</code> (YoutubeChannel) no conozca los detalles de sus observadores. Solo sabe que implementan la interfaz <code>Observer</code> y tienen un método <code>update</code>. Esto es un ejemplo de <strong>Inversión de Dependencias</strong>.</p>
    </li>
    <li>
        <strong>Gestión de Suscripciones:</strong> 
        <p>La lista interna <code>List&lt;Observer&gt;</code> permite una relación uno-a-muchos dinámica. Los objetos pueden suscribirse y desuscribirse en tiempo de ejecución sin afectar al funcionamiento interno del sujeto.</p>
    </li>
</ul>

<h2 class="subtitle">Ejemplo de Uso</h2>

<div class="center-horizontal">
<pre><code class="language-java">
public class Main {
    public static void main(String[] args) {
        YoutubeChannel myChannel = new YoutubeChannel("CodeChannel");

        Subscriber s1 = new Subscriber("Alice");
        Subscriber s2 = new Subscriber("Bob");

        myChannel.subscribe(s1);
        myChannel.subscribe(s2);

        myChannel.uploadVideo("Patrón Observer en Java");
        
        System.out.println("--- Bob se desuscribe ---");
        myChannel.unsubscribe(s2);

        myChannel.uploadVideo("Patrón Singleton en Java");
    }
}
</code></pre>
</div>

<div class="center-horizontal">
<pre><code class="language-plaintext">
Output:
CodeChannel ha subido un nuevo video: Patrón Observer en Java
Hola Alice, ¡hay un nuevo video: Patrón Observer en Java!
Hola Bob, ¡hay un nuevo video: Patrón Observer en Java!
--- Bob se desuscribe ---
CodeChannel ha subido un nuevo video: Patrón Singleton en Java
Hola Alice, ¡hay un nuevo video: Patrón Singleton en Java!
</code></pre>
</div>
