<style>
    .title, .subtitle, strong {
        color: black !important;
    }
</style>
<h1 class="title">Patrón Command</h1>

<p>El patrón <strong>Command</strong> es un patrón de comportamiento que convierte una solicitud en un objeto independiente que contiene toda la información sobre la solicitud. Esta transformación permite parametrizar métodos con diferentes solicitudes, retrasar o poner en cola la ejecución de una solicitud y soportar operaciones que no se pueden deshacer.</p>

<h2 class="subtitle">Propósito</h2>
<p>Desacoplar el objeto que invoca la operación del objeto que sabe cómo realizarla.</p>

<h2 class="subtitle">Caso de Uso Real: Editor de Texto (Undo/Redo)</h2>
<p><strong>Contexto:</strong> En un editor como Word, el usuario puede escribir, borrar, pegar texto, poner negrita, etc. Y espera poder pulsar <code class="language-java">Ctrl+Z</code> para deshacer la última acción.</p>

<p><strong>El Problema:</strong> Si la interfaz gráfica llama directamente a la lógica de negocio (<code class="language-java">document.copy()</code>), no guardamos un historial de qué operación se hizo, por lo que no podemos deshacerla.</p>

<p><strong>La Solución (Command):</strong> Encapsulamos cada operación como un objeto (<code class="language-java">CopyCommand</code>, <code class="language-java">PasteCommand</code>).
<br>Estos objetos tienen método <code class="language-java">execute()</code> y <code class="language-java">undo()</code>. Cuando el usuario pulsa un botón, se crea el comando, se ejecuta y se guarda en una pila "Historial". Al pulsar Deshacer, simplemente sacamos el último comando de la pila y llamamos a <code class="language-java">undo()</code>.</p>

<h2 class="subtitle">Análisis de la Implementación</h2>

<ul>
    <li>
        <strong>Desacoplamiento Invocador-Receptor:</strong> 
        <p>El <code class="language-java">RemoteControl</code> (Invocador) no sabe que está encendiendo una luz. Solo sabe que tiene un objeto <code class="language-java">Command</code> y que debe llamar a <code class="language-java">execute()</code>. Esto permite reutilizar el mismo botón para encender luces, abrir puertas o lanzar misiles.</p>
    </li>
    <li>
        <strong>Comandos como Objetos de Primera Clase:</strong> 
        <p>Al convertir una acción en un objeto, podemos manipularla (guardarla en listas, encolarla, pasarla por red). Esto es la base para Job Queues y Sistemas de Transacciones.</p>
    </li>
</ul>

<h2 class="subtitle">Implementación</h2>

<div class="center-horizontal">
<pre><code class="language-java">
// Comando
interface Command {
    void execute();
}

// Receptor
class Light {
    public void on() {
        System.out.println("Luz encendida");
    }
    public void off() {
        System.out.println("Luz apagada");
    }
}

// Comandos Concretos
class LightOnCommand implements Command {
    private Light light;

    public LightOnCommand(Light light) {
        this.light = light;
    }

    @Override
    public void execute() {
        light.on();
    }
}

class LightOffCommand implements Command {
    private Light light;

    public LightOffCommand(Light light) {
        this.light = light;
    }

    @Override
    public void execute() {
        light.off();
    }
}

// Invocador
class RemoteControl {
    private Command command;

    public void setCommand(Command command) {
        this.command = command;
    }

    public void pressButton() {
        command.execute();
    }
}
</code></pre>
</div>
<span class="center-horizontal caption">Estructura Command</span>

<br>

<h2 class="subtitle">Ejemplo de Uso</h2>

<div class="center-horizontal">
<pre><code class="language-java">
public class Main {
    public static void main(String[] args) {
        RemoteControl remote = new RemoteControl();
        Light light = new Light();

        Command lightsOn = new LightOnCommand(light);
        Command lightsOff = new LightOffCommand(light);

        // Encender
        remote.setCommand(lightsOn);
        remote.pressButton();

        // Apagar
        remote.setCommand(lightsOff);
        remote.pressButton();
    }
}
</code></pre>
</div>

<div class="center-horizontal">
<pre><code class="language-java">
Output:
Luz encendida
Luz apagada
</code></pre>
</div>
