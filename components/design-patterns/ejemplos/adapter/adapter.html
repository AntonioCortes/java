<style>
    .title, .subtitle, strong {
        color: black !important;
    }
</style>
<h1 class="title">Patrón Adapter</h1>

<p>El patrón <strong>Adapter</strong> es un patrón estructural que permite que objetos con interfaces incompatibles colaboren entre sí. Actúa como un "enchufe" adaptador entre dos objetos.</p>

<h2 class="subtitle">Propósito</h2>
<p>Convertir la interfaz de una clase en otra interfaz que esperan los clientes. Permite que clases trabajen juntas que de otra forma no podrían debido a interfaces incompatibles.</p>

<h2 class="subtitle">Caso de Uso Real: Integración de API de Análisis de Mercado (XML vs JSON)</h2>
<p><strong>Contexto:</strong> Tienes una aplicación de finanzas que descarga datos de bolsa en formato XML. Sin embargo, decides integrar una potente librería de análisis de terceros que solo acepta datos en JSON.</p>

<p><strong>El Problema:</strong> No puedes cambiar la librería (es de terceros) y reescribir todo tu core para usar JSON rompería otras integraciones XML existentes. Tienes dos interfaces incompatibles.</p>

<p><strong>La Solución (Adapter):</strong> Creas una clase intermedia (<code class="language-java">XmlToJsonAdapter</code>) que implementa la interfaz que tu aplicación espera (o la de la librería, dependiendo de la dirección). 
<br>Cuando llamas al adaptador, este convierte internamente los datos XML a JSON y se los pasa a la librería de análisis, devolviendo el resultado en el formato esperado. El código cliente no se entera de la transformación.</p>

<h2 class="subtitle">Análisis de la Implementación</h2>

<ul>
    <li>
        <strong>Composición (Object Adapter):</strong> 
        <p>El adaptador <em>contiene</em> una instancia del objeto a adaptar (<code class="language-java">AdvancedMediaPlayer</code>). Esto es preferible a la herencia porque permite adaptar objetos de cualquier subclase de <code class="language-java">AdvancedMediaPlayer</code> dinámicamente.</p>
    </li>
    <li>
        <strong>Principio de Responsabilidad Única:</strong> 
        <p>Separamos la lógica de conversión de datos (en el adaptador) de la lógica de negocio principal. Si el formato de entrada cambia, solo tocamos el adaptador.</p>
    </li>
</ul>

<h2 class="subtitle">Implementación</h2>

<div class="center-horizontal">
<pre><code class="language-java">
// Target: Lo que el cliente espera usar
interface MediaPlayer {
    void play(String audioType, String fileName);
}

// Adaptee: Una interfaz diferente pero útil
class AdvancedMediaPlayer {
    public void playVlc(String fileName) {
        System.out.println("Playing vlc file: " + fileName);
    }
    public void playMp4(String fileName) {
        System.out.println("Playing mp4 file: " + fileName);
    }
}

// Adapter: Implementa Target y usa Adaptee
class MediaAdapter implements MediaPlayer {
    AdvancedMediaPlayer advancedMusicPlayer;

    public MediaAdapter(String audioType) {
        if (audioType.equalsIgnoreCase("vlc")) {
            advancedMusicPlayer = new AdvancedMediaPlayer();
        } else if (audioType.equalsIgnoreCase("mp4")) {
            advancedMusicPlayer = new AdvancedMediaPlayer();
        }
    }

    @Override
    public void play(String audioType, String fileName) {
        if (audioType.equalsIgnoreCase("vlc")) {
            advancedMusicPlayer.playVlc(fileName);
        } else if (audioType.equalsIgnoreCase("mp4")) {
            advancedMusicPlayer.playMp4(fileName);
        }
    }
}

// Cliente que usa el Adapter
class AudioPlayer implements MediaPlayer {
    MediaAdapter mediaAdapter;

    @Override
    public void play(String audioType, String fileName) {
        // Soporte nativo para mp3
        if (audioType.equalsIgnoreCase("mp3")) {
            System.out.println("Playing mp3 file: " + fileName);
        }
        // MediaAdapter provee soporte para otros formatos
        else if (audioType.equalsIgnoreCase("vlc") || audioType.equalsIgnoreCase("mp4")) {
            mediaAdapter = new MediaAdapter(audioType);
            mediaAdapter.play(audioType, fileName);
        }
        else {
            System.out.println("Formato no soportado: " + audioType);
        }
    }
}
</code></pre>
</div>
<span class="center-horizontal caption">Estructura Adapter</span>

<br>

<h2 class="subtitle">Ejemplo de Uso</h2>

<div class="center-horizontal">
<pre><code class="language-java">
public class Main {
    public static void main(String[] args) {
        AudioPlayer audioPlayer = new AudioPlayer();

        audioPlayer.play("mp3", "cancion.mp3");
        audioPlayer.play("mp4", "video.mp4");
        audioPlayer.play("vlc", "pelicula.vlc");
        audioPlayer.play("avi", "video.avi");
    }
}
</code></pre>
</div>

<div class="center-horizontal">
<pre><code class="language-java">
Output:
Playing mp3 file: cancion.mp3
Playing mp4 file: video.mp4
Playing vlc file: pelicula.vlc
Formato no soportado: avi
</code></pre>
</div>
